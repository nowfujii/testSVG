<!DOCTYPE html><html lang="ja" dir="ltr">	<head>		<meta charset="utf-8">		<title>Leaflet地図</title>	</head><!-- leaflet -->	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script><!-- ICON plugin -->	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"><!-- easy button-->	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css">	<script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script><!-- point in polygon for Leaflet https://github.com/mapbox/leaflet-pip-->	<script src="https://unpkg.com/@mapbox/leaflet-pip@latest/leaflet-pip.js"></script><!-- 日本地図GeoJson/　都道府県データpref-->	<link rel="stylesheet" href="index2.css">	<script src="index2.js"></script>	<body>		<!--背景色用-->		<div id="nuri"></div>		<!--地図用-->		<div id="map">		<!--十字マーク-->			<div id="cross">				<IMG id="_cross" src="https://maps.gsi.go.jp/image/map/crosshairs.png" style="visibility: hidden">  <!--visilbe / hidden-->			</div>		</div>	</body></html><script type="text/javascript">//--------------------------------------------------------------------------------------------------------------------// Java Script//--------------------------------------------------------------------------------------------------------------------	//グローバル変数定義	var maptype        = 0;                   //ベース地図種類 0:地-白、1:地-標準、2:地-単色、3:地-写真、4:OSM-JP、5:OSM-ORG、6,G-標準、7:G-道路、8:G-写真、9:G-ハイブリッド	var id             = 0;                   //都道府県ID	var wid            = 0;                   //国名ID	var pref           = "";                  //都道府県名	var country        = 0;                   //国名ID	var countrytag     = "";                  //国名	var zoom           = 6;                   //ズーム	var lat            = 34.6878788;          //現在の緯度	var lng            = 135.5060062;         //現在の経度	var lat2           = 0;                   //移動先の緯度	var lng2           = 0;                   //移動先の経度	//定数	var jlat           = 34.6878788;          //日本地図大阪　緯度	固定値	var jlng           = 135.5060062;         //日本地図大阪　経度	固定値	var wlat           = 21.453068633086783;  //世界地図中心　緯度	固定値	var wlng           = 9.316406250000002;   //世界地図中心　経度	固定値	//フラグ	var localnameFlg   = false;               //地方名色別         true:ON false:OFF	var transparentFlg = false;               //選択時不透明       true:ON false:OFF	var gpsmarkerFlg   = false;               //現在地マーカー     true:ON false:OFF	var prefmarkerFlg  = false;               //県庁所在地マーカー true:ON false:OFF	var seireimarkerFlg= false;               //政令指定都市マーカーtrue:ON false:OFF	var popupFlg       = false;               //ポップアップ表示   true:ON false:OFF	var stateFlg       = false;               //６大州色別         true:ON false:OFF	var capitalFlg     = false;               //首都マーカー       true:ON false:OFF	var transworldFlg  = false;               //世界選択時不透明   true:ON false:OFF	//今いる市区町村の情報	var population     = 0;                   //人口	var area           = 0;                   //面積	var density        = 0;                   //人口密度	//役所名	var building       = "";                  //役場名	var buildingyomi   = "";                  //役場名よみ	var ylat           = 0;                   //役場lat	var ylng           = 0;                   //役場lng	//アイコン設定	//var crossIcon = L.icon({ iconUrl: 'https://maps.gsi.go.jp/image/map/crosshairs.png' , iconSize: [64, 64], iconAnchor: [32, 32] });	//divIconをセット	var divIcon1  = L.divIcon({ html: '◎', className: 'divicon1', iconAnchor: [18,25]});	//県庁所在地マーカー	var divIcon2  = L.divIcon({ html: '●', className: 'divicon2', iconAnchor: [24,24]});	//GPSマーカー	var divIcon3  = L.divIcon({ html: '●', className: 'divicon3', iconAnchor: [11,17]});	//首都マーカー	var divIcon4  = L.divIcon({ html: '●', className: 'divicon4', iconAnchor: [24,24]});	//役場マーカー	var divIcon5  = L.divIcon({ html: '◎', className: 'divicon5', iconAnchor: [18,25]});	//政令指定都市マーカー	//ベースレイヤー：地図サイト設定	var bm = new Array(14);	for (var i = 0; i < geomapsJson.maps.length; i++){		bm[i] = new L.tileLayer(geomapsJson.maps[i].addr, {			attribution:   geomapsJson.maps[i].attr,			id:            geomapsJson.maps[i].id,			minNativeZoom: geomapsJson.maps[i].minNativeZoom,			maxNativeZoom: geomapsJson.maps[i].maxNativeZoom,			minZoom:       geomapsJson.maps[i].minZoom,			maxZoom:       geomapsJson.maps[i].maxZoom			//useCache: true, crossOrigin: true,		});	};	//console.log(bm);	//baseMapsのタグもJsonへ埋め込んだので配列に展開	var tag = new Array(14);	for (var i = 0; i < geomapsJson.maps.length; i++){		tag[i] = geomapsJson.maps[i].tag;	};	//console.log(tag);	//baseMapsオブジェクトのプロパティに複数のベースレイヤーを設定	var baseMaps = {		[tag[ 0]] : bm[ 0],		[tag[ 1]] : bm[ 1],		[tag[ 2]] : bm[ 2],		[tag[ 3]] : bm[ 3],		[tag[ 4]] : bm[ 4],		[tag[ 5]] : bm[ 5],		[tag[ 6]] : bm[ 6],		[tag[ 7]] : bm[ 7],		[tag[ 8]] : bm[ 8],		[tag[ 9]] : bm[ 9],		[tag[10]] : bm[10],		[tag[11]] : bm[11],		[tag[12]] : bm[12],		[tag[13]] : bm[13],	};	//console.log(baseMaps);	//leaflet初期設定  //標準ズームをキャンセルし、ズーム間隔を細かくします // true:Canvasレンダラー/ false:SVGを選択	var map = L.map('map', { attributionControl: false, zoomControl: false, zoomSnap: 0.1, preferCanvas:true, });	//パラメータを分解し変数へ代入	analyArgv(window.location.href);	//ベース地図初期設定	baseMapSelect();	//初期表示位置、ズーム設定	if (lat2 == 0) {		map.setView([lat, lng], zoom);	} else {		map.setView([lat2, lng2], zoom);	};	//著作表示：左下	L.control.attribution({ position: 'bottomleft'}).addTo(map);	//スケール表示：左上	L.control.scale({ maxWidth: 500, position: 'topleft', metric: true, imperial: false, updateWhenIdle: false }).addTo(map);	//ズームボタン表示：右下	L.control.zoom({ position: 'bottomright' , zoomInTitle: 'ズームイン', zoomOutTitle: 'ズームアウト'}).addTo(map);	//地図表示全体表示ボタン	L.easyButton({		position: 'bottomright', // topleft, topright, bottomleft, bottomright		states: [{							stateName: 'zoom-to-japan',         // 状態のIDのようなもの							icon:      'fas fa-map-marker-alt', // 使用するアイコン https://fontawesome.com/icons?d=gallery&p=2&m=free							title:     '日本全体',              // マウスオーバー時にツールチップに表示される名前							onClick: function(btn, map) {								map.setView([jlat,jlng],5);       // 日本地図の中心（大阪）								btn.state('zoom-to-world');}      // ボタンクリック後の状態を指定						 },						 {							stateName: 'zoom-to-world',         // 状態のIDのようなもの							icon:      'fas fa-globe',          // 使用するアイコン https://fontawesome.com/icons?d=gallery&p=2&m=free							title:     '世界全体',              // マウスオーバー時にツールチップに表示される名前							onClick: function(btn, map) {								map.setView([wlat,wlng],2);       // 世界地図の中心位置								btn.state('zoom-to-japan');}      // ボタンクリック後の状態を指定						 }]	}).addTo( map );	//レイヤーグループ定義	var geoJsonGroup		= new L.layerGroup();	//日本地図	var worldJsonGroup		= new L.layerGroup();	//世界地図	var prefMarkerGroup		= new L.layerGroup();	//県庁所在地マーカー	var wdMarkerGroup		= new L.layerGroup();	//首都マーカー	var gpsMarkerGroup		= new L.layerGroup();	//GPSマーカー	var seireiMarkerGroup	= new L.layerGroup();	//政令指定都市マーカー//  var crossGroup   = new L.layerGroup();	//オーバーレイヤー：日本地図、世界地図　2種類づつ定義	var geoJsonColor		= new L.geoJson(japanJson, { style: style,  onEachFeature: onEachFeature  });  //日本：都道府県別カラー塗り	var geoJsonClear		= new L.geoJson(japanJson, { style: style2, onEachFeature: onEachFeature2 });  //日本：白塗り	var worldJsonColor		= new L.geoJson(worldJson, { style: style3, onEachFeature: onEachFeature3 });  //世界：州別カラー塗り	var worldJsonClear		= new L.geoJson(worldJson, { style: style4, onEachFeature: onEachFeature4 });  //世界：白塗り	//レイヤーグループセット	geoJsonGroup.addLayer(geoJsonColor);      //日本地図データ　地方カラー塗	geoJsonGroup.addLayer(geoJsonClear);      //日本地図データ　白塗	worldJsonGroup.addLayer(worldJsonColor);  //世界地図データ　6大州カラー塗	worldJsonGroup.addLayer(worldJsonClear);  //世界地図データ　白塗	//日本：政令指定都市マーカーとポップアップ　レイヤーグループセット	for (var i=0; i < SeireiJson.marker.length; i++){		//マーカークリック時のポップアップ設定		var popup = L.popup({maxWidth:500}).setContent(			"<center><span style='font-size:40px'>"+"【<ruby>"+"政令指定都市"+"<rt>"+"せいれいしていとし"+"</rt>"+"</ruby>"+ "】<br>"+"</span>"+			"<span style='font-size:50px'>"+"<ruby>"+SeireiJson.marker[i].pref+"<rt>"+SeireiJson.marker[i].prefyomi+"</rt>"+"</ruby>"+ "<br></span>"+			"<span style='font-size:60px'>"+"<ruby>"+SeireiJson.marker[i].city+"<rt>"+SeireiJson.marker[i].cityyomi+"</rt>"+"</ruby>"+ "<br></span>"+			"<span style='font-size:40px'>"+"人口:"+"<rt>"+SeireiJson.marker[i].population+"</rt>"+"</ruby>"+ "人<br></span>"+			"<span style='font-size:40px'>"+"面積:"+SeireiJson.marker[i].area+ "㎢<br></span>"+			"<span style='font-size:40px'>"+"人口密度:"+SeireiJson.marker[i].density+ "㎢/人<br></span>"+			+"</span></center>"		);		var mk = L.marker( [SeireiJson.marker[i].lat, SeireiJson.marker[i].lng], { draggable: false, icon:divIcon5}).bindPopup(popup);		seireiMarkerGroup.addLayer(mk);	};	//日本：県庁所在地マーカーとポップアップ　レイヤーグループセット	for (var i=0; i < prefJson.marker.length; i++){		//マーカークリック時のポップアップ設定		var popup = L.popup({maxWidth:500}).setContent(			"<center><span style='font-size:40px'>"+"【<ruby>"+"県庁所在地"+"<rt>"+"けんちょうしょざいち"+"</rt>"+"</ruby>"+ "】<br>"+"</span>"+			"<span style='font-size:60px'>"+"<ruby>"+prefJson.marker[i].city+"<rt>"+prefJson.marker[i].cityyomi+"</rt>"+"</ruby>"+ "<br>"+"</span></center>"		);		var mk = L.marker( [prefJson.marker[i].lat, prefJson.marker[i].lng], { draggable: false, icon:divIcon1}).bindPopup(popup);		prefMarkerGroup.addLayer(mk);	};	//世界：首都マーカーとポップアップ　レイヤーグループセット	for (var i=0; i < capitalJson.marker.length; i++){		//マーカークリック時のポップアップ設定		var popup = L.popup({maxWidth:500}).setContent(			"<center><span style='font-size:40px'>"+"【<ruby>"+"首都"+"<rt>"+"しゅと"+"</rt>"+"</ruby>"+ "】<br>"+"</span>"+			"<span style='font-size:40px'>" + capitalJson.marker[i].capital + "<br>"+"</span></center>"		);		var mk = L.marker( [capitalJson.marker[i].lat, capitalJson.marker[i].lng], { draggable: false, icon:divIcon3 }).bindPopup(popup);		wdMarkerGroup.addLayer(mk);	};	//現在地マーカーとポップアップ	var popup = L.popup().setContent("<span style='font-size:60px'>"+"<ruby>"+"現在地"+"<rt>"+"げんざいち"+"</rt>"+"</ruby>"+ "<br>"+"</span>");	var mk = L.marker( [lat, lng], { draggable: false, icon:divIcon2 }).bindPopup(popup).openPopup(popup);	gpsMarkerGroup.addLayer(mk);	// コントローラーの選択追加	var overlayLayerControls = {		"<span style='font-size:40px'>現在地Xマーク</span>":		gpsMarkerGroup,		"<span style='font-size:40px'>日本：地方色別</span>":		geoJsonColor,		"<span style='font-size:40px'>日本：白塗り</span>":			geoJsonClear,		"<span style='font-size:40px'>日本：県庁所在地</span>":		prefMarkerGroup,		"<span style='font-size:40px'>日本：政令指定都市</span>":	seireiMarkerGroup,		"<span style='font-size:40px'>世界：六大州色別</span>":		worldJsonColor,		"<span style='font-size:40px'>世界：白塗り</span>":			worldJsonClear,		"<span style='font-size:40px'>世界：首都</span>":			wdMarkerGroup,//    "<span style='font-size:40px'>十字マーク</span>": crossGroup,	};	//グループ初期設定	groupSelect();//  crossGroup.addTo(map);    //十字マーク	//地図選択ボタン	L.control.layers(baseMaps, overlayLayerControls, { collapsed: true,}).addTo(map);//--------------------------------------------------------------------------------------------------------------------//イベント//--------------------------------------------------------------------------------------------------------------------	//移動終了時	map.on('moveend', function(e) {//    info01.update(zoomLev);//    info01.update(centerLatLng);	// 十字マークのGPS位置を表示する		var mes = "lat: " + map.getCenter().lat + " lng: " + map.getCenter().lng;		console.log(mes);		//plugin lng,lat の位置にあるGetJsonオブジェクトを取得する//    var layer = leafletPip.pointInLayer([ map.getCenter().lng, map.getCenter().lat], geoJsonClear); //日本/*    var layer = leafletPip.pointInLayer([ map.getCenter().lng, map.getCenter().lat], worldJson);    //世界		//GeoJsonオブジェクトがあればzoomイベントを起こす		if (layer.length > 0) {			var id = layer ? layer[0].feature.properties.id : 'none';			var countryName = worldJson.marker[id].country;			console.log("layerName: "+countryName);		}*///    if (window.Unity){ Unity.call(mes); }//Unityへ送信	});//--------------------------------------------------------------------------------------------------------------------//インタラクション//--------------------------------------------------------------------------------------------------------------------	// 現在地を取得	function getgeo() {		map.on('locationerror', onLocationError);		map.locate({			setView: "true"		});	};	function onLocationError(e) {		alert(e.message);	};	//--------------------------------------------------------------------------------------------------------------------	//地方別Geojson:クリック時の動作	//--------------------------------------------------------------------------------------------------------------------	//通常表示 // 黒枠カラー塗りスタイル	function style(feature) { return { color: '#000', fillColor: getColor(feature.properties.id), weight: 1, opacity: 1, fillOpacity: 1 }; };	function getColor(id) {		var group = prefJson.marker[id-1].group;		//console.log(Group);      //デバッグ表示			return  group == "北海道地方" ? '#796BAF':							group == "東北地方"   ? '#6C9BD2':							group == "関東地方"   ? '#54C3F1':							group == "中部地方"   ? '#61C1BE':							group == "近畿地方"   ? '#69BD83':							group == "四国地方"   ? '#C1DB81':							group == "中国地方"   ? '#FFF67F':							group == "九州地方"   ? '#F9C270':																			'#EF845C';																			//#EF858C																			//#EE87B4																			//#BA79B1	};	//イベント時の挙動設定	function onEachFeature(feature, layer) {		if (popupFlg){ setInfo(layer); }		layer.on({ mouseover:  highlightFeature, mouseout:   resetHighlight, click:      zoomToFeature, });	};	//日本カラー：マウスホバー時　カラーハイライト/リセット	function highlightFeature(e) { e.target.setStyle({ color: '#000', fillColor: '#f00', weight: 1, opacity: 1, fillOpacity: 0.1}); };	//マウスホバー時　ハイライト表示　リセット	function resetHighlight(e) { geoJsonColor.resetStyle(e.target); };	//日本：クリック時のイベントとして呼ばれる　ズーム	function zoomToFeature(e) {		map.fitBounds(e.target.getBounds(), {maxZoom:8 });    //都道府県のサイズと位置にフィットしズームも自動調整される  最大バウンドズーム設定		console.log(e.target.feature.properties.pref);      //デバッグ表示		if (window.Unity){ Unity.call(e.target.feature.properties.pref); }; //Unityへ送信	};	//日本：都道府県データのセット	function setInfo(layer) {		var i = layer.feature.properties.id-1;		if (i >= 0 && i < 47){			var id         = prefJson.marker[i].id;			var pref       = prefJson.marker[i].pref;//      var city       = prefJson.marker[i].city;			var group      = prefJson.marker[i].group;			var prefyomi   = prefJson.marker[i].prefyomi;//      var cityyomi   = prefJson.marker[i].cityyomi;			var LGyomi     = prefJson.marker[i].LGyomi;//      var url        = prefJson.marker[i].url;//      var addr       = prefJson.marker[i].addr;//      var lat        = prefJson.marker[i].lat;//      var lng        = prefJson.marker[i].lng;			//地方名＋都道府県名　ポップアップ　セット			var popup = L.popup({maxWidth:600}).setContent(				"<center>"+				"<span style='font-size:40px'>【<ruby>" + group + "<rt>" + LGyomi + "</rt>" + "</ruby>" + "】<br></span>" +				"<span style='font-size:60px'>" + id + ":" + "<ruby>" + pref + "<rt>" + prefyomi + "</rt>" + "</ruby>" + "<br></span>" +				"</center>"			);			layer.bindPopup (popup);		};	};	//--------------------------------------------------------------------------------------------------------------------	//日本透明:クリック時の動作	// 黒枠透明スタイル	function style2(feature) { return { color: '#000', fillColor: '#fff',                 weight: 1, opacity: 1, fillOpacity: 1 }; };	//イベント時の挙動設定	function onEachFeature2(feature, layer) {		if (popupFlg){ setInfo(layer); }		layer.on({ mouseover:  highlightFeature2, mouseout:   resetHighlight2, click:      zoomToFeature, });	};	//ハイライト	function highlightFeature2(e) { e.target.setStyle({ color: '#000', fillColor: '#f00', weight: 1, opacity: 1, fillOpacity: 0.1 }); };	//リセット	function resetHighlight2(e) { geoJsonColor.resetStyle(e.target); };	//--------------------------------------------------------------------------------------------------------------------	//世界：透明:クリック時の動作	function style3(feature) { return { color: '#000', fillColor: getColor3(feature.properties.id), weight: 1, opacity: 1, fillOpacity: 1 }; };	function getColor3(id) {		var state = capitalJson.marker[id-1].state;		//console.log(State);      //デバッグ表示			return  state == "南極"       ? '#796BAF':							state == "ヨーロッパ" ? '#6C9BD2':							state == "北アメリカ" ? '#54C3F1':							state == "アジア　"   ? '#61C1BE':							state == "南アメリカ" ? '#69BD83':							state == "オセアニア" ? '#C1DB81':							state == "アフリカ"   ? '#FFF67F':																			'#F9C270';																		//'#EF845C':																		//'#EF858C':																		//'#EE87B4':																		//'#BA79B1':	};	//イベント時の挙動設定	function onEachFeature3(feature, layer) {		if (popupFlg){ SetInfo3(layer); }		layer.on({ mouseover:  highlightFeature3, mouseout:   resetHighlight3, click:      zoomToFeature3, });	};	//世界透明：マウスホバー時ハイライト	function highlightFeature3(e) { e.target.setStyle({ color: '#000', fillColor: '#f00', weight: 1, opacity: 1, fillOpacity: 0.1 }); };	//リセット	function resetHighlight3(e) { worldJsonColor.resetStyle(e.target); };	//世界：クリック時のイベントとして呼ばれる　ズーム	function zoomToFeature3(e) {		//map.fitBounds(e.target.getBounds(), {maxZoom:7 });    //可能な最大ズームレベルで、指定された地理的境界を含むマップビューを設定します		//map.panTo(e.target.LatLng);                           //マップを特定の中心にパンします		//map.flyTo(e.target.LatLng);                           //スムーズなパンズームアニメーションを実行するマップのビュー（地理的中心とズーム）を設定します。		//map.flyToBounds((e.target.getBounds());               //滑らかなアニメーションのようなマップのビューを設定しますが、のflyToような境界パラメータを取ります		console.log(e.target.feature.properties.a3);            //デバッグ表示		if (window.Unity){ Unity.call(e.target.feature.properties.a3); };    //Unityへ送る	}	//世界：首都データのセット	function SetInfo3 (layer) {		var i = layer.feature.properties.id-1;		if (i >= 0 && i < 211) {			var id         = capitalJson.marker[i].id;			var a3         = capitalJson.marker[i].a3;			var country    = capitalJson.marker[i].country;			var countrytag = capitalJson.marker[i].countrytag;			var capital    = capitalJson.marker[i].capital;			var state      = capitalJson.marker[i].state;			var area       = capitalJson.marker[i].area;			var lat        = capitalJson.marker[i].lat;			var lng        = capitalJson.marker[i].lng;			//id:a3 / 【州】/ 国名 　ポップアップ　セット			layer.bindPopup ( "<center><span style='font-size:25px'>" +												id + ":" + a3 + "<br>" +												"【" + state + "】<br>" +												"(" + area + ")<br>" +												countrytag + "<br>" +												"</span></center>"											);		};	};	//--------------------------------------------------------------------------------------------------------------------	//世界：透明:クリック時の動作	function style4(feature) { return { color: '#000', fillColor: '#fff',                 weight: 1, opacity: 1, fillOpacity: 1 }; };	//イベント時の挙動設定	function onEachFeature4(feature, layer) {		if (popupFlg){ SetInfo3(layer); }		layer.on({ mouseover:  highlightFeature4, mouseout:   resetHighlight4, click:      zoomToFeature3, });	};	//世界透明：マウスホバー時ハイライト	function highlightFeature4(e) { e.target.setStyle({ color: '#000', fillColor: '#f00', weight: 2, opacity: 1, fillOpacity: 0.1 }); };	//リセット	function resetHighlight4(e) { worldJsonClear.resetStyle(e.target); };//--------------------------------------------------------------------------------------------------------------------// Unityから送信されてきた時の処理//--------------------------------------------------------------------------------------------------------------------	if (window.Unity){		//-------------------------------------------------------------------------		//Unityから送られてくる実験		//-------------------------------------------------------------------------		Unity.LoadJs = function(data){			console.log(data);		};		//-------------------------------------------------------------------------		//日本の都道府県1-47		//-------------------------------------------------------------------------		Unity.japanParamJs = function(param){			console.log(param);			//パラメータを分解し変数へ代入			analyArgv(param);			//ベース地図設定			baseMapSelect();			//レイヤーグループ初期設定			groupSelect();			//現在位置から指定された都道府県へFlyToさせる			//zoom = 8;                                                     //一旦固定ズーム			map.flyTo([lat2, lng2], zoom , { duration: 1 });			var mes = "japanParam: lat2:" + lat2 + " lng2:" + lng2 + " zoom:" + zoom;			console.log(mes);			if (window.Unity){ Unity.call(mes); };			//全国へ			//map.setView([jlat, jlng], zoom);		};		//-------------------------------------------------------------------------		//世界各国1-211		//-------------------------------------------------------------------------		Unity.worldParamJs = function(param){			console.log(param);			//パラメータを分解し変数へ代入			analyArgv(param);			//ベース地図設定			baseMapSelect();			//レイヤーグループ初期設定			groupSelect();			//現在位置から指定された国へFlyToさせる			//zoom = 8;                                                                   //一旦固定ズーム			map.flyTo([lat2, lng2], zoom , { duration: 1 });			var mes = "worldParam: lat2:" + lat2 + " lng2:" + lng2 + " zoom:" + zoom;			console.log(mes);			if (window.Unity){ Unity.call(mes); };			//全世界へ			//zoom = 3;                                                                   //一旦固定ズーム			//map.setView([wlat, wlng], zoom);		};		//-------------------------------------------------------------------------		//日本住んでいる場所の役場の位置、役場名、役場名よみ、人口、面積、人口密度		//-------------------------------------------------------------------------		Unity.yakubaParamJs = function(param){			console.log(param);			//パラメータを分解し変数へ代入			analyArgv(param);			//ベース地図設定			baseMapSelect();			//レイヤーグループ初期設定			groupSelect();			//役場の位置にマーカー表示ポップアップは最初表示する			var popup = L.popup({maxWidth:800}).setContent(				"<span style='font-size:60px'><ruby>" + building +"<rt>"+ buildingyomi + "</rt></ruby><br></span>" +				"<span style='font-size:40px'><ruby>人口<rt>じんこう</rt></ruby>：" + population + "人<br></span>" +				"<span style='font-size:40px'><ruby>面積<rt>めんせき</rt></ruby>：" + area + "㎢<br></span>" +				"<span style='font-size:40px'><ruby>人口密度<rt>じんこうみつど</rt></ruby>：" + density + "人/㎢<br></span>" +				"<span style='font-size:20px'>※2020/10/01現在<br></span>" +				"<span style='font-size:20px'>※総務省統計局：国勢調査確定人口<br></span>" +				"<span style='font-size:20px'>※国土交通省国土地理院：全国都道府県市区町村別面積調<br></span>"			);			var mk = L.marker( [ylat, ylng], { draggable: false, icon: divIcon4 }).addTo(map);			mk.bindPopup(popup).openPopup();			//現在位置から指定された都道府県へFlyToさせる			//zoom = 18;                                                     //一旦固定ズーム			map.flyTo([ylat, ylng], zoom , { duration: 1 });			var mes = "japanParam: ylat:" + ylat + " ylng:" + ylng + " zoom:" + zoom;			console.log(mes);			if (window.Unity){ Unity.call(mes); };			//全国へ			//map.setView([jlat, jlng], zoom);		};	};//--------------------------------------------------------------------------------------------------------------------//ARGV:パラメータ解析しグローバル変数を更新//--------------------------------------------------------------------------------------------------------------------	function analyArgv(param) {		//Unityから送信されてきたパラメータを分解		if(getParam('maptype',        param)) maptype    = getParam('maptype',        param); //ベース地図 番号		if(getParam('id',             param)) id         = getParam('id',             param); //都道府県ID		if(getParam('wid',            param)) wid        = getParam('wid',            param); //国名ID		if(getParam('pref',           param)) pref       = getParam('pref',           param); //都道府県名		if(getParam('country',        param)) country    = getParam('country',        param); //国名		if(getParam('countrytag',     param)) countrytag = getParam('countrytag',     param); //国名タグ		if(getParam('zoom',           param)) zoom       = getParam('zoom',           param); //ズーム		if(getParam('lat',            param)) lat        = getParam('lat',            param); //緯度　現在地		if(getParam('lng',            param)) lng        = getParam('lng',            param); //経度		if(getParam('lat2',           param)) lat2       = getParam('lat2',           param); //緯度　移動先		if(getParam('lng2',           param)) lng2       = getParam('lng2',           param); //経度		if(parseBool(getParam('localnameFlg',   param))) localnameFlg   = parseBool(getParam('localnameFlg',   param));   //地方名色別         true:ON false:OFF		if(parseBool(getParam('transparentFlg', param))) transparentFlg = parseBool(getParam('transparentFlg', param));   //選択時不透明       true:ON false:OFF		if(parseBool(getParam('gpsmarkerFlg',   param))) gpsmarkerFlg   = parseBool(getParam('gpsmarkerFlg',   param));   //現在地マーカー     true:ON false:OFF		if(parseBool(getParam('prefmarkerFlg',  param))) prefmarkerFlg  = parseBool(getParam('prefmarkerFlg',  param));   //県庁所在地マーカー true:ON false:OFF		if(parseBool(getParam('seireimarkerFlg',param))) seireimarkerFlg= parseBool(getParam('seireimarkerFlg',  param));   //政令指定都市マーカー true:ON false:OFF		if(parseBool(getParam('popupFlg',       param))) popupFlg       = parseBool(getParam('popupFlg',       param));   //ポップアップ表示   true:ON false:OFF		if(parseBool(getParam('stateFlg',       param))) stateFlg       = parseBool(getParam('stateFlg',       param));   //６大州色別         true:ON false:OFF		if(parseBool(getParam('transworldFlg',  param))) transworldFlg  = parseBool(getParam('transworldFlg',  param));   //世界選択時不透明   true:ON false:OFF		if(parseBool(getParam('capitalFlg',     param))) capitalFlg     = parseBool(getParam('capitalFlg',     param));   //首都マーカー       true:ON false:OFF		if(getParam('ylat',           param)) ylat       = getParam('ylat',           param); //役場緯度		if(getParam('ylng',           param)) ylng       = getParam('ylng',           param); //役場経度		if(getParam('building',       param)) building   = getParam('building',       param); //役場名		if(getParam('buildingyomi',   param)) buildingyomi = getParam('buildingyomi', param); //役場名よみ		if(getParam('population',     param)) population = getParam('population',     param); //人口		if(getParam('area',           param)) area       = getParam('area',           param); //面積		if(getParam('density',        param)) density    = getParam('density',        param); //人口密度		var mes1 = "mes1:maptype:"+ maptype + " id:"+ id+ " wid:"+ wid + " pref:" + pref + " lat2:" + lat2 + " lng2:" + lng2 + " zoom:" + zoom		console.log(mes1);		var mes2 = "mes2:localname:"+ localnameFlg + " transparent:" + transparentFlg + " gpsmarker:" + gpsmarkerFlg + " prefmarker:" + prefmarkerFlg+ " seireimarker:" + seireimarkerFlg + " popup:" + popupFlg + " state:" + stateFlg + " transworld:" + transworldFlg + " capital:" + capitalFlg;		console.log(mes2);		var mes3 = "mes3:building:" + building + " buildingyomi:" + buildingyomi + " ylat:" + ylat + " ylng:" + ylng;		console.log(mes3);		var mes4 = "mes4:population:" + population + " area:" + area + " density:" + density;		console.log(mes4);		//日本地図のフラグがあり、id指定があれば設定		if (getParam('id', param) != null && id != 0){			wid   = 0;			id    = getParam('id', param);			pref  = prefJson.marker[id-1].pref;			lat2  = prefJson.marker[id-1].lat2;			lng2  = prefJson.marker[id-1].lng2;			zoom  = prefJson.marker[id-1].zoom;			var mes = "id:" + id + " 都道府県:" + pref + " lat2:" + lat2 + " lng2:" + lng2 + "zoom:" + zoom;			console.log(mes);			if (window.Unity){ Unity.call(mes); }		};		//世界地図のフラグがあり、id指定があれば設定		if (getParam('wid', param) != null && wid != 0){			id         = 0;			wid        = getParam('wid', param);			country    = capitalJson.marker[wid-1].country;			countrytag = capitalJson.marker[wid-1].countrytag;			lat2       = capitalJson.marker[wid-1].lat;			lng2       = capitalJson.marker[wid-1].lng;			var mes = "wid:" + wid +" country:" + country + "countrytag:" + countrytag + "lat2:" + lat2 + "lng2:" + lng2;			console.log(mes);			if (window.Unity){ Unity.call(mes); };		};	};//--------------------------------------------------------------------------------------------------------------------//ベース地図初期設定//--------------------------------------------------------------------------------------------------------------------	function baseMapSelect(){		if (map === undefined || map === null || bm === null || bm === undefined) {			console.log("baseMapSelect: map/bm どっちかが null/undefined");			console.log(map);			console.log(bm);			return;		} else {			bm[0].remove();			bm[1].remove();			bm[2].remove();			bm[3].remove();			bm[4].remove();			bm[5].remove();			bm[6].remove();			bm[7].remove();			bm[8].remove();			bm[9].remove();			bm[10].remove();			bm[11].remove();			bm[12].remove();			bm[13].remove();			switch(maptype){				case  '0':	bm[0].addTo(map);	console.log("0:addTo");			break;				case  '1':	bm[1].addTo(map);	console.log("1:addTo");			break;				case  '2':	bm[2].addTo(map);	console.log("2:addTo");			break;				case  '3':	bm[3].addTo(map);	console.log("3:addTo");			break;				case  '4':	bm[4].addTo(map);	console.log("4:addTo");			break;				case  '5':	bm[5].addTo(map);	console.log("5:addTo");			break;				case  '6':	bm[6].addTo(map);	console.log("6:addTo");			break;				case  '7':	bm[7].addTo(map);	console.log("7:addTo");			break;				case  '8':	bm[8].addTo(map);	console.log("8:addTo");			break;				case  '9':	bm[9].addTo(map);	console.log("9:addTo");			break;				case '10':	bm[10].addTo(map);	console.log("10:addTo");		break;				case '11':	bm[11].addTo(map);	console.log("11:addTo");		break;				case '12':	bm[12].addTo(map);	console.log("12:addTo");		break;				case '13':	bm[13].addTo(map);	console.log("13:addTo");		break;				default:	bm[0].addTo(map);	console.log("default:addTo");	break;			};			//console.log("baseMapSelect: " + maptype);			//console.log(bm);		};	};//--------------------------------------------------------------------------------------------------------------------//グループ初期設定//--------------------------------------------------------------------------------------------------------------------	function groupSelect(){		if (map === undefined || map === null) {			console.log("groupSelect: map が null/undefined");			console.log(map);			return;		} else {			worldJsonColor.		remove();			worldJsonClear.		remove();			wdMarkerGroup.		remove();			geoJsonColor.		remove();			geoJsonClear.		remove();			prefMarkerGroup.	remove();			seireiMarkerGroup.	remove();			gpsMarkerGroup.		remove();			if (stateFlg       && worldJsonColor	!= undefined && worldJsonColor		!= null) worldJsonColor.addTo(map);		//世界六大州			if (transworldFlg  && worldJsonClear	!= undefined && worldJsonClear		!= null) worldJsonClear.addTo(map);		//世界：選択時不透明			if (capitalFlg     && wdMarkerGroup		!= undefined && wdMarkerGroup		!= null) wdMarkerGroup.addTo(map);		//首都マーカー			if (localnameFlg   && geoJsonColor		!= undefined && geoJsonColor		!= null) geoJsonColor.addTo(map);		//地方名別色			if (transparentFlg && geoJsonClear		!= undefined && geoJsonClear		!= null) geoJsonClear.addTo(map);		//選択時不透明			if (prefmarkerFlg  && prefMarkerGroup	!= undefined && prefMarkerGroup		!= null) prefMarkerGroup.addTo(map);	//県庁所在地マーカー			if (seireimarkerFlg&& seireiMarkerGroup	!= undefined && seireiMarkerGroup	!= null) seireiMarkerGroup.addTo(map);	//政令指令都市マーカー			if (gpsmarkerFlg   && gpsMarkerGroup	!= undefined && gpsMarkerGroup		!= null) gpsMarkerGroup.addTo(map);		//現在地マーカー			console.log("groupSelect:"  );		};	};//--------------------------------------------------------------------------------------------------------------------// Get the URL parameter value//// @param  name {string} パラメータのキー文字列// @return  url {url} 対象のURL文字列（任意）//--------------------------------------------------------------------------------------------------------------------	function getParam(name, url) {			if (!url) url = window.location.href;			name = name.replace(/[\[\]]/g, "\\$&");			var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),					results = regex.exec(url);			if (!results) return null;			if (!results[2]) return '';			return decodeURIComponent(results[2].replace(/\+/g, " "));	};//--------------------------------------------------------------------------------------------------------------------// 文字列のboolからboolをパースする//// @param   value {} bool文字列// @return  true/false/null//--------------------------------------------------------------------------------------------------------------------function parseBool(value) {	switch (value) {		case true:		case 'true':		case 1:		case '1':			return true;		case false:		case 'false':		case 0:		case '0':			return false;		default:			return null;	};};</script>